---
title: "SENSORS and ACTUATORS 6.13"
emoji: "👀"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: [SensorFusion]
published: false
---

## センサフュージョン
- 二つ以上のセンサからのデータを組み合わせて，単一センサでは得られない情報を抽出したり，精度や信頼性の向上のために用いられる
    - 姿勢推定（角加速度センサ + 加速度センサ）
    - 複数の画像を組み合わせて，3次元情報を復元
    - 両眼融合による立体視
- センサフュージョンは，データフュージョンのサブセット
    - データがセンサから直接得られない場合もある
    - 事前の知識や経験とのフュージョン
    - 複数の出力値を使用して，単一の状態変数を推定（カルマンフィルタ）
- データフュージョンは，情報フュージョンのサブセット
    - 単なるデータではなく，質的な情報や高レベルの情報を推定
    - ソフトセンサからの情報
    - 五感の情報を統合して脳で判断する
    - 微生物やアンモニア等の揮発性窒素の含有量から食品の品質


[計測できないパラメータを人工知能で計算する『ソフトセンサー技術』に迫る](https://minsaku.com/category02/post201/)

# 6.13.1 Nature and Types of Fusion
- 低レベルの入力
    - 物体の速度の数値
- 高レベルの入力
    - センサデータから抽出した特徴量
- 低レベルの出力
    - 物体の向きの角度
- 高レベルの出力
    - 製品の品質・分類，エージェントの行動
- 並行使用，順次使用どちらも可能

## 6.13.1.1 Fusion Architectures
- 補完的フュージョン
- 競合的フュージョン
    - レーダーとカメラによる物体認識
    - ミリ波レーダーは段ボールや発泡スチロールなどの伝播反射率の弱い物体の検出が難しいが，光源や天候に影響を受けない
    - カメラは夜間や逆光に弱いが，電波反射が弱い物体でも検出可能
- 協調的フュージョン
    - 測定に必要な情報を提供する
    - センサが特定の役割を与えられているのが補完的フュージョンとの違い
- 集中型フュージョン
- 分散型フュージョン
- 同種のフュージョン
    - 関係するセンサがすべて同一
- 異種のフュージョン
    - 関係するセンサが異なる（タイプ，能力など）
- ウォーターフォール型フュージョン
    - センシング→前処理→特徴抽出→パターン処理→状況判断→意思決定
    - 階層型フュージョン
- データレベル
    - センサデータそのもの
- 特徴量レベルのフュージョン
    - 形状抽出
    - 加速度データからピークを検出
- 決定レベルのフュージョン
    - 物体検出
    - パターン認識

[センサフュージョンによるフリースペース認識技術の開発](https://www.jstage.jst.go.jp/article/jsaeronbun/51/2/51_20204100/_pdf)
[自動運転車向けセンサーまとめ！LiDAR、ミリ波レーダー、カメラ](https://jidounten-lab.com/y_autonomous-sensors-3#_-6)

# 6.13.2 Sensor Fusion Applications
- 具体例
    - GPS，機械学習，ビジネス上の意思決定，知的交通システム，気象予測，医療診断，遠隔医療，エキスパートシステム，家電，娯楽，軍事，防衛，自動車，航空，宇宙，ロボット，立体映像，プロセス制御，自動化，診断・予知モニタリング，多解像度画像融合，指紋，虹彩スキャンを用いたバイオメトリクス認証
- 立体視映像
    - 二台のカメラで同じ対象物を撮影する
    - 画像を合成することで，3D画像を表現
    - カメラ間の距離とカメラと被写体の距離の比率は1/400以上である必要がある
    - 一般的には1/80程度である
    - 植生や構造物の高さを推定する場合に適している
- 軍事用途
    - 潜水艦の探知と位置確認
    - 複数の水中ソナーからのセンサ情報が衛星システムを介して船上のコンピュータに送信される
    - 潜水艦の位置を特定し，軍用機に伝達
- 物体認識におけるマルチスペクトルデータのフュージョン
    - 低周波の画像特徴（画像の大きな物体）を正確に提供
    - 高周波の画像特徴（物体のエッジ）を正確に提供
    - より優れた物体認識と特徴量の算出（スペクトルの分解能）
- フィルタの組み合わせ
    - 一つの周波数特性では十分な効果が得られない場合，異なる周波数特性を組み合わせる
    - ローパスフィルタとバンドパスフィルタを組み合わせて，フィルタの帯域を広げるようなもの
- センサの組み合わせ
    - 傾斜計とレートジャイロを組み合わせる
    - 傾斜計は低帯域のセンサ
        - コンデンサプレート間の液体が傾くことで誘電率が変わり，傾斜角が得られる
    - レートジャイロは高周波も取得できるがドリフトの問題がある
        - バイアス誤差が時間と共に変動する
        - センサ内部の温度が代わることによって生じる
    - 相補フィルタで周波数特性のいいとこどりをする
        - ゲインが1になるように調整

[ジャイロ計と傾斜計を複合させたリアルタイム姿勢角検出器](https://www.sice.jp/ia-j/papers/21_10IA040.pdf)
[相補フィルタ](https://yuqlid.sakura.ne.jp/dokuwiki/%E7%9B%B8%E8%A3%9C%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF)

## 6.13.2.1 Enabling Technologies
- MEMS
- デジタル信号処理
- 統計的推測
    - ベイズ推論
    - カルマンフィルタ
- ソフトコンピューティング
    - ファジー理論，ニューラルネットワーク，進化的計算
- 人工知能
    - 特徴抽出，パターン認識，分類

# 6.13.3 Approaches of Sensor Fusion
- ニューラルネットワーク
- ファジー理論
- カーネル法（サポートベクターマシン）
- 確率的法（ベイズ推論，デンプスター，シェーファー理論，カルマンフィルタ）

## 6.13.3.1 Bayesian Approach to Sensor Fusion
- 複数のセンサデータから必要な情報を推論
- モデル誤差や測定誤差が含まれる
- 推定のためのデータが複数のセンサから得られる推定問題
- 最尤推定を用いてセンサフュージョン

[機械学習の理解に必須！ベイズ統計学の基礎の基礎](https://sitest.jp/blog/?p=5484)

## 6.13.3.2 Continuous Gaussian Problem
- 測定値から推定値を決定する
- 測定値はモデル誤差と測定誤差をもつ
- モデル誤差は真の値に影響を与える未知の外乱
- 複数センサの情報を用いた自動運転
    - モデル誤差を推定して性能を向上
    - エンジンの調子やタイヤの摩耗状態など時間と共に代わるモデル誤差を推定

[ガウス過程回帰の使い方と注意点](https://datachemeng.com/post-4106/)
[【論文読み】ガウス過程で自動運転](https://qiita.com/shinmura0/items/071827d21aa788f67eb6)

## 6.13.3.3 Sensor Fusion Using Kalman Filter
- 複数の出力値を使用して，単一の状態変数を推定
    - 位置，内部温度
- モデル誤差や測定誤差のようなノイズや外乱を除去または補正する能力がある
- 全て（r個）のセンサに対して，r個の測定値がr次の測定ベクトルとして表される単一の測定モデルを使用
    - r個の測定値すべて同時に（並列に）カルマンフィルタを適用
- r個のセンサにr個の異なる測定モデルを使用
    - 現在使用しているセンサに応じて，適切な出力式をカルマンフィルタで使用
    - r個のセンサの測定値にカルマンフィルタを順次適用
    - システムがすべてのr個の測定モデルに対して別々に観測可能であればよい
- センサフュージョンには線形・拡張・アンスケントなど，どのカルマンフィルタでも使用可能

[カルマンフィルタってなに？](https://qiita.com/IshitaTakeshi/items/740ac7e9b549eee4cc04)
[特集：カルマンフィルタを中心とした状態推定の理論から応用まで](https://www.jstage.jst.go.jp/article/sicejl/56/9/56_629/_pdf)

## 6.13.3.4 Sensor Fusion Using Neural Networks
- ニューラルネットワークの特徴
    - 多くのセンサなどからの入力を受け付けることができる
    - 学習することができる
    - 高度な非線形関数を近似することができる
    - 膨大な計算能力を持つ
    - 処理した情報を記憶することができる
- 各ノードは重みづけされて繋がっている
    - 入力層
    - 一つ以上の隠れ層
    - 出力層
- 入力層のノードに複数のセンサからのデータが与えたれる
- 隠れ層でセンサフュージョンが行われる
- 出力層のノードによってフュージョンの出力が提供される
- あるノードから別のノードへフィードバックがある場合も
    - リカレントネットワーク
    - 記憶の機能を提供する

### 6.13.3.4.1 Learning
- NNを学習させる
    - 正しい行動には報酬を，間違った行動にはペナルティを与える仕組み
- 教師付き学習では，外部の教師が入力と出力のデータセットを提供
    - 学習時には，与えられた入力に対してネットワークの出力が望ましいかを比較
    - 学種ルール（勾配法など）を用いて，誤差が最小になるようにネットワークのパラメータを学習
- 教師なし学習では，学習のための入出力例を提供する教師はいない
    - 事前に学習した知識，ガイドライン，ローカル情報，内部制御などを用いてネットワークのパラメータを更新する
    - 正しい接続は事前に分からない
    - 入力データをネットワークに与え，ネットワークの出力を諸々に基づいてチェック
    - 適応ルールを用いてネットワークのパラメータを変更する
- 強化学習は教師なし学習の一種
    - パフォーマンスとそれに対応する環境からのフィードバック情報（正解か不正解か）に応じてネットワークの接続を変更
    - 正解なら対応する接続を強化（報酬）
    - 不正解なら対応する接続を弱める（ペナルティ）

### Hybrid Use with Fuzzy Logic (Neuro-Fuzzy Systems)
- ファジー理論とニューラルネットワークを統合
    - ファジー理論は人間の推論メカニズムをある程度模倣
    - センサフュージョンによく用いられる
- NNをファシリテーター / ツールとしてファジー理論に組み込む
    - NNを使ってルールやメンバーシップ関数を学習・トレーニングする
- センサデータの特徴を表現するためにファジー理論を使用する
- ファジーサブシステムとNNサブシステムを別々に使用して，異なるフュージョンを行う
    - ファジーシステムは高レベルの監督 / 調整アクションのために情報フュージョンを行い，NNはフィードバック制御のために低レベルのセンサデータを直接フュージョン

### 6.13.3.4.2 Example: Machine Fault Diagnosis
- センサフュージョンは機械の健全性監視，故障検出，診断に良く用いられる
- 産業プロセスや機械のモニタリングには，複数の異なるセンサが使用される
- 魚の自動切断機械
    - 魚の詰まり
    - 油圧シリンダーシステムの故障
    - コンベアシステムの故障
    - 油圧ポンプの故障
    - 油圧サーボバルブの故障
    - 空圧制御されたカッターの故障
- 機械の故障診断のためのニューロ・ファジーネットワーク
    - マイク，カメラ，加速度計などのセンサを使用
    - 前処理の後，特徴量抽出
    - カメラ画像からSIFT特徴量を抽出（コンベアで移動する魚）
    - 振動や音の信号を周波数スペクトルにして特徴ベクトルを定義
    - 典型的な故障のデータサンプルを用いてNNを学習
    - ファジー理論システムは，定式化や修正が容易
    - 脱ファジー化が必要
    - NNは複雑な非線形関係を表現可能でカテゴリーに分類することが得意
    - NNは制度の限界や学習コストの問題がある
    - 6番目の出力は普通の状態

[ファジィ推論](https://ocw.hokudai.ac.jp/wp-content/uploads/2016/01/IntelligentInformationProcessing-2005-Note-09.pdf)
[FAULT DIAGNOSIS OF AN INDUSTRIAL MACHINE THROUGH SENSOR FUSION](https://sci-hub.se/https://doi.org/10.1142/S0219878908001521)